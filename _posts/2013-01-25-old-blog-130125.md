---
layout: post
title: "javascipt, asp.net - 드롭다운리스트 ajax 로 item 바인딩"
date: 2013-01-25 12:00:00
comments: false
categories: old blog
---

ddlClsCd 가 변경되면 ddlWrktCd 안의 아이템들 바뀌는 경우 C#에서 컨트롤 안돼서 
그냥 C#단에서 스트링으로 만든다음 페이지단에서 스플릿트로 썼음

//페이지단
{% highlight ruby %}
<td><asp:DropDownList ID="ddlClsCd" runat="server" onchange="onChangeClsCd(this.id);"></asp:DropDownList></td>
<td><asp:DropDownList ID="ddlWrktCd" runat="server"></asp:DropDownList></td>
function onChangeClsCd(ddlId) {
    var control = document.getElementById(ddlId);
    var returnValue = "";
    returnValue = WEC_CM_CM_PC_P.SetDDLTypesOfWorkAjax(control.options[control.selectedIndex].value).value;
    var ddlWrktCd = document.getElementById("<%=ddlWrktCd.ClientID %>");
    var ddlWrktCdLenth = ddlWrktCd.options.length;
    for(var i = 0; i<ddlWrktCdLenth; i++){
        ddlWrktCd.remove(0);
    }
    var items = returnValue.split('|');
    for(var i = 0; i<items.length - 1; i++) {
        var item = new Option(items[i].split(',')[0], items[i].split(',')[0]);
        ddlWrktCd.options.add(item);
    }
}
{% endhighlight %}

//C#단
{% highlight ruby %}
[Ajax.AjaxMethod()]
public string SetDDLTypesOfWorkAjax(string selectedItemIndex)
{
    string strReturnValue = string.Empty;
    LST.Biz.SYS.Common_NTx Biz = new LST.Biz.SYS.Common_NTx();
    Dictionary<string, string>Dic = new Dictionary<string, string>();
    Dic.Add("COMM_CD", "SC" + selectedItemIndex);
    Dic.Add("PJT_CD", UserInfo.PJT_CD);
    Dic.Add("LANG", UserInfo.LANG);
    DataTable dtList = Biz.SELECT_PB_SYS_CD_LST(Dic);
    for (int i = 0; i<dtList.Rows.Count; i++)
    {
        strReturnValue = strReturnValue + dtList.Rows[i]["DETL_CDNM"].ToString() + "," + dtList.Rows[i]["DETL_CD"].ToString() + "|";
    }
    return strReturnValue;
} 
{% endhighlight %}
