---
layout: post
title: "android - sepia, greyscale 변환"
date: 2011-04-04 12:00:00
comments: false
categories: old blog
---

//세피아 변환
{% highlight ruby %}
public Bitmap sepia(Bitmap bitmap){
    Log.e(log, "Convert Sepia");
    int width, height, r,g, b, c, gry; 
    height = bitmap.getHeight(); 
    width = bitmap.getWidth(); 
    int depth = 20;
    Bitmap bmpSephia = Bitmap.createBitmap(width, height, Bitmap.Config.ARGB_8888);
    Canvas canvas = new Canvas(bmpSephia);
    Paint paint = new Paint();
    ColorMatrix cm = new ColorMatrix();
    cm.setScale(.3f, .3f, .3f, 1.0f); 
    ColorMatrixColorFilter f = new ColorMatrixColorFilter(cm);
    paint.setColorFilter(f);
    canvas.drawBitmap(bitmap, 0, 0, paint);
    for(int x=0; x<width; x++) {
        for(int y=0; y<height; y++) {
            c = bitmap.getPixel(x, y);
            r = Color.red(c);
            g = Color.green(c);
            b = Color.blue(c);
            gry = (r + g + b) / 3;
            r = g = b = gry;
            r = r + (depth * 2);
            g = g + depth;
            if(r>255) {
                r = 255;
            }
            if(g>255) {
                g = 255;
            }
            bmpSephia.setPixel(x, y, Color.rgb(r, g, b));
        }
    } 
    return mbitmap = bmpSephia;
} 
{% endhighlight %}

//위에처럼 하니까 상당히 느리다ㅜㅜ 

{% highlight ruby %}
mImageView.setImageBitmap(Bitmap.createBitmap(mRgbImage.getData(), width, height, Bitmap.Config.ARGB_8888));
mImageView.setColorFilter(0xFFFFDAB9, Mode.MULTIPLY); 
{% endhighlight %}
//필터 쓰니까 그나마 빠름

//greyscale 변환   
{% highlight ruby %}
public void greyScale(boolean storePrevious) { 
    //mRgbImage는 bitmap>>RGBIMAGE로 covert한것 
    int[] rgbData = mRgbImage.getData();
    if (storePrevious) {
        prevRgbImage = (RgbImage) mRgbImage.clone();
    }
    for (int y = 0; y<height; y++) {
        int outputOffset = y * width;
        for (int x = 0; x<width; x++) {
            int index = outputOffset + x;
            int R = ((rgbData[index]>>16)&0xff);
            int G = ((rgbData[index]>>8)&0xff);
            int B = ((rgbData[index])&0xff);
            int grey = (R + G + B) / 3;
            rgbData[index] = 0xff000000 | (grey<<16) | (grey<<8) | grey;
        }
    }
    mbitmap = RgbImageAndroid.toBitmap(mRgbImage);
} 
{% endhighlight %}